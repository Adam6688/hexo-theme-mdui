<!-- Import JS -->
<% if(theme.vendors.outdatedbrowser_min_js) { %>
  <script type="text/javascript" src="<%= theme.vendors.outdatedbrowser_min_js %>"></script>
<% } else { %>
  <%- js("js/outdatedbrowser.min") %>
<% } %>
<script>
//event listener: DOM ready
function addLoadEvent(func) {
  var oldonload = window.onload;
  if (typeof window.onload != 'function') {
      window.onload = func;
  } else {
      window.onload = function() {
          if (oldonload) {
              oldonload();
          }
          func();
      }
  }
}
//call plugin function after DOM ready
addLoadEvent(function(){
  outdatedBrowser({
      bgColor: '#f25648',
      color: '#ffffff',
      lowerThan: 'transform',
      languagePath: ''
  })
});
</script>

<% if(theme.vendors.js_min_js) { %>
  <script type="text/javascript" src="<%= theme.vendors.js_min_js %>"></script>
<% } else { %>
  <%- js("js/js") %>
<% } %>

<% if (theme.service_woker === true || theme.service_woker === 'pwa') { %>
  <script>
    if ('serviceWorker' in navigator) {
     navigator.serviceWorker.register('/sw.js');
    }
  </script>
<% } %>

<% if (theme.busuanzi !== false) { %>
  <script src="<%= theme.busuanzi.busuanzi_pure_mini_js %>"></script>
<% } %>
<% if (is_home() || is_archive() || is_year() || is_month() || is_category() || is_tag()) { %>
  <script type="text/javascript">
    var fab_index = new mdui.Headroom('#fab_index', {
      pinnedClass: 'fab',
      unpinnedClass: 'mdui-fab-hide'
    });
    (function() {
      var items = document.querySelectorAll("#content-list .content-item");
      var list = document.querySelector(".posts-container");
      var columns = [document.createElement("div"), document.createElement("div"), document.createElement("div")];
      var level = 4;
      var sm = 1;
      var column1Width = 600;
      var column2Width = 1024;
      list.innerHTML = "";
      function getColumnNums() {
        if (document.body.clientWidth <= column1Width) {
          return 1
        }
        if (document.body.clientWidth <= column2Width) {
          return 2
        }
        return 3
      }
      function updateList() {
        var ColumnNums = getColumnNums();
        if (level == ColumnNums) return;
        level = ColumnNums;
        list.setAttribute("class", "column-" + ColumnNums + " posts-container")
        Array.prototype.forEach.call(items, function(value, index) {
          var to = index % ColumnNums;
          columns[to].appendChild(value);
        })
        columns.forEach(function(value) {
          list.appendChild(value)
        })
      }
      window.addEventListener("resize", updateList);
      updateList();
    })()
  </script>
<% } %>
<% if (!is_home()) { %>
  <script type="text/javascript">
  $(document).on('click', '.back-button', function() {
      window.history.back();
  });
  </script>
<% } %>
<% if (!is_post() && theme.translations.snackbar && page.total > 1) { %>
  <script type="text/javascript">
    $(document).on('click', 'a[name="snackbar"]', function () {
      mdui.snackbar({
        message: '<%= theme.translations.snackbar %>',
        timeout: 1000
      });
    });
  </script>
<% } %>
<% if (!is_home() && !is_archive() && !is_year() && !is_month() && !is_category() && !is_tag()) { %>
  <script type="text/javascript">
    $(document).ready(function(){
      if($(".toc").length == 0)
      {
        $("#button-toc").addClass("mdui-hidden");
        $("#post").addClass("no-toc")
      };
    });
  </script>

  <script>
  $('#post-content img').click(function() {
    var img_src = $(this).attr('src');
    var img_alt = $(this).attr('alt');
    $(this).lightGallery({
      dynamic: true,
      dynamicEl: [{
        "src": img_src,
        'subHtml': "<p>" + img_alt + "</p>"
        }],
    });
  })
  </script>

  <!-- MathJax Load-->
  <% if (page.mathjax) { %>
    <%- partial('../widget/mathjax') %>
  <% } %>
<% } %>

<!-- Custom javascript -->
<%-partial('../custom/custom_js')%>
